!function(e){"use strict";var t=function(){var t=this;this.init=function(){this.$productPage=e("div.product"),this.productPage=document.querySelector("div.product"),this.general(),this.reviewsBtn(),this.handleQtyInputMinStep(),this.reviewsForm(),this.addedToCartText(),this.fsSkinErrors(),this.runLazyReviews(),this.runLazyRelated(),this.runLazyUpsells(),this.events()},this.events=function(){e(document).on("focus",".rey-cartBtnQty input.--select-text",(function(e){e.currentTarget.select()})),rey.hooks.addAction("first_interaction",(function(){setTimeout((function(){t.customTextNearPrice()}),2e3)}))},this.reviewsBtn=function(){var e=document.querySelector(".js-reviewsBtn");if(e){var t=document.querySelector(".rey-wcPanel--reviews #reviews");t&&(e.classList.contains("--toggled")?rey.dom.isHidden(t)&&rey.animation.slideDown(t):rey.dom.isHidden(t)||(t.style.display="none"),e.addEventListener("click",(function(e){e.preventDefault(),e.currentTarget.classList.contains("--toggled")?(e.currentTarget.classList.remove("--toggled"),rey.animation.slideUp(t)):(e.currentTarget.classList.add("--toggled"),rey.animation.slideDown(t))})),e&&rey.dom.delegate(document,"click",'.woocommerce-review-link, a[href="#reviews"]',(function(r){var o=rey.dom.offset(e).top;o&&(r.preventDefault(),window.scrollTo({top:o-30,behavior:"smooth"})),rey.dom.isHidden(t)&&e.click()})))}},this.reviewsForm=function(){if(reyParams.ajax_add_review){var e=document.querySelector("#comments .commentlist");rey.dom.delegate(document,"submit","#respond form.comment-form",(function(t){t.preventDefault();var r=t.initiator,o=r.querySelector("#comment");if(o)if(o.value){t.submitter.classList.add("loading-spin");var a=rey.util.getFormData(r);Object.keys(a).length?rey.ajax.request("submit_review",{formData:a,params:{cache:!1},cb:function(o){if(o&&o.success&&o.data){if(!e)return t.submitter.value=reyParams.ajax_add_review_reload_text,void setTimeout((function(){window.location.reload()}),1e3);t.submitter.classList.remove("loading-spin"),rey.dom.insertHtml(e,"afterbegin",o.data),window.scrollTo({top:rey.dom.offset(e).top,behavior:"smooth"});var a=document.getElementById("review_form");a&&(a.style.display="none"),r.reset()}}}):console.error("Form data empty. Please reload and try again.")}else o.style.borderColor="red";else console.error("Missing comment field.")}))}},this.addedToCartText=function(){e(document.body).on("added_to_cart",(function(t,r,o,a){if(void 0!==reyParams.added_to_cart_text){var i;if(a)if(a.hasClass("single_add_to_cart_button")&&!a.hasClass("elementor-button"))i=a,a=e(".single_add_to_cart_button-text",a);else if(a.hasClass("add_to_cart_button")){var n=e(".__text",a);n.length?a=n:a.children(".rey-icon").length&&(a=null)}if(a){var s=a.text();a.text(reyParams.added_to_cart_text);var d=parseInt(reyParams.added_to_cart_text_timeout||0);d&&setTimeout((function(){a.text(s),i&&i.removeClass("added")}),d)}}}))},this.fsSkinErrors=function(){if(!rey.vars.is_desktop){var t=e(".single-skin--fullscreen .woocommerce-notices-wrapper");t.length&&t.detach().prependTo(this.$productPage)}},this.general=function(){e('.rey-qtySelect ~ input[name^="quantity"]').remove()},this.ajaxLoadMoreReviews=function(){e(document).on("click",".rey-ajaxRatings-addBtn, .rey-reviewTop-add",(function(t){t.preventDefault();var r=e("#review_form_wrapper"),o=r.offset().top;r.children("#review_form").show("fast"),e("html, body").animate({scrollTop:o-rey.vars.adminBar-25},"fast",(function(e){return--e*e*e+1})),setTimeout((function(){e(document).trigger("reycore/woocommerce/reviews/loaded")}),100)}));var t=e(".rey-ajaxRatings-btn");if(t.length){var r=JSON.parse(t.attr("data-config")||"{}");if(r.qid&&r.total){var o,a=r.total,i=0,n=e("#reviews ol.commentlist"),s="newest",d=function(d,c){o&&o.abort(),o=rey.ajax.request("load_more_reviews",{data:{qid:r.qid,page:i,order:d||s},cb:function(r){t.removeClass("--disabled"),r.success&&r.data?(e("li.__loader",n).remove(),e(r.data).appendTo(n),t.removeClass("--loading"),i++,e(".__count",t).attr("data-current",i),i===a&&t.addClass("--disabled").removeClass("--loading"),c&&c.removeClass("--disabled"),e(document).trigger("reycore/woocommerce/reviews/loaded"),o=!1):t.addClass("--disabled").removeClass("--loading")}})};d(),t.on("click",(function(e){e.preventDefault(),t.addClass("--loading"),d()})),e(document).on("click",".rey-reviewSort li[data-key]",(function(){var r=e(this),o=r.parent(),a=r.attr("data-key");o.addClass("--disabled"),n.empty(),e('<li class="__loader"><div class="rey-lineLoader"></div></li>').appendTo(n),t.addClass("--disabled"),e(".__count",t).attr("data-current",1),r.siblings().removeClass("--active"),r.addClass("--active"),i=0,d(a,o),s=a}))}}},this.runLazyUpsells=function(){if(this.$productPage.length){var t=e(".__placeholder-wrapper.upsells.products");if(t.length){var r=rey.vars.page_id;r&&rey.frontend.inView({target:t,once:!0,cb:function(){rey.ajax.request("upsells_products",{ss:"upsells_products_"+r,data:{id:r},cb:function(e){if(e.data){t.replaceWith(e.data);var r=document.querySelector(".upsells.products");rey.hooks.doAction("product/loaded",r.querySelectorAll("li.product")),rey.hooks.doAction("woocommerce/carousel/loaded",r),rey.hooks.doAction("elementor/content/lazy_loaded",r)}}})}})}}},this.runLazyRelated=function(){if(this.$productPage.length){var t=e(".__placeholder-wrapper.related.products");if(t.length){var r=rey.vars.page_id;r&&rey.frontend.inView({target:t,once:!0,cb:function(){rey.ajax.request("related_products",{ss:"related_products_"+r,data:{id:r},cb:function(e){if(e.data){t.replaceWith(e.data);var r=document.querySelector(".related.products");rey.hooks.doAction("product/loaded",r.querySelectorAll("li.product")),rey.hooks.doAction("woocommerce/carousel/loaded",r),rey.hooks.doAction("elementor/content/lazy_loaded",r)}}})}})}}},this.runLazyReviews=function(){var t=this,r=e(".woocommerce-Reviews.--ajax");if(r.length){if(r.closest(".rey-summaryAcc").length)return e(document).one("click",".rey-summaryAcc-accItem.--reviews",(function(){t.ajaxLoadMoreReviews()})),void e(document).one("click",".reviews_acctab > a.--reviews",(function(){t.ajaxLoadMoreReviews()}));var o=r.closest(".woocommerce-Tabs-panel").length;if(o&&r.is(":visible"))return t.ajaxLoadMoreReviews();r.is(":visible")||o||!e(".rey-reviewsBtn").length?o?e(document).one("click",".reviews_tab > a",(function(){t.ajaxLoadMoreReviews()})):rey.hooks.addAction("first_interaction",(function(){setTimeout((function(){t.ajaxLoadMoreReviews()}),2e3)})):e(document).one("click",".rey-reviewsBtn",(function(){t.ajaxLoadMoreReviews()}))}},this.customTextNearPrice=function(){var t=e("span[data-price-text]",this.$productPage);t.length&&rey.ajax.request("pdp_custom_price_text",{data:{pid:t.attr("data-price-text")},params:{cache:!1},cb:function(e){e.data&&(rey.hooks.applyFilters("reycore/woocommerce/price_text/replace",!0,e,t)&&t.first().replaceWith(e.data),document.dispatchEvent(new CustomEvent("reycore/woocommerce/price_text_loaded",{detail:{response:e}})))}})},this.handleQtyInputMinStep=function(){rey.dom.delegate(document,"change","div.product input.qty",(function(e){var t=parseFloat(e.initiator.getAttribute("min")||0),r=parseFloat(e.initiator.getAttribute("step")||0),o=parseFloat(e.initiator.value);if(t&&t>o)e.initiator.value=t;else if(r&&o%r!=0){var a=Math.floor(o/r)*r;t&&(a=Math.max(t,a)),e.initiator.value=a}}))},this.init()};document.addEventListener("rey-DOMContentLoaded",(function(){new t}));var r={};e(document.body).on("found_variation reset_data",".variations_form",(function(t,o){var a=t.currentTarget.closest("div.product");if(a){a.classList.toggle("--found-variation","object"==typeof o);var i=e(".rey-estimatedDelivery",a);if(i.length){var n=a.getAttribute("id");r[n]||(r[n]=i.html()),o&&o.estimated_delivery?i.html(o.estimated_delivery):i.html(r[n])}}}))}(jQuery);